{% extends 'base.html' %}
{% load i18n staticfiles %}

{% block title %}Tag Status - {{ block.super }}{% endblock %}
{% block extra_head %}
    <link rel="stylesheet" type="text/css" href="{% static "css/jquery.dataTables.css" %}">
    <link rel="stylesheet" type="text/css" href="{% static "css/responsive.dataTables.min.css" %}">
    <script type="text/javascript" charset="utf8" src="{% static "js/jquery.dataTables.js" %}"></script>
    <script type="text/javascript" charset="utf8" src="{% static "js/dataTables.responsive.min.js" %}"></script>

    <script type="text/javascript">
        var TAG_STATUS = '{% url 'tag_status' %}';
        // translations for datatables

        var dt_language = {
            "emptyTable": "{% trans "No data available in table" %}",
            "info": "{% trans "Showing _START_ to _END_ of _TOTAL_ entries" %}",
            "infoEmpty": "{% trans "Showing 0 to 0 of 0 entries" %}",
            "infoFiltered": "",
            "infoPostFix": "",
            "thousands": ",",
            "lengthMenu": "{% trans "Show _MENU_ entries" %}",
            "loadingRecords": "{% trans "Loading..." %}",
            "processing": "{% trans "Processing..." %}",
            "search": "{% trans "Search:" %}",
            "zeroRecords": "{% trans "No matching records found" %}",
            "paginate": {
                "first": "{% trans "First" %}",
                "last": "{% trans "Last" %}",
                "next": "{% trans "Next" %}",
                "previous": "{% trans "Previous" %}"
            },
            "aria": {
                "sortAscending": "{% trans ": activate to sort column ascending" %}",
                "sortDescending": "{% trans ": activate to sort column descending" %}"
            }
        }

        $(document).ready(function () {
            var table = $('#statustable').DataTable({
                language: dt_language,  // global variable defined in html
                order: [[0, "asc"]],
                lengthMenu: [[15, 25, 50, 100, 200], [15, 25, 50, 100, 200]],
                columnDefs: [
                    {
                        orderable: true,
                        searchable: true,
                        className: "center",
                        targets: [0, 1]
                    }
                ],
                searching: true,
                processing: true,
                serverSide: false,
                stateSave: true,
                responsive: true,
                ajax: TAG_STATUS,
                "rowCallback": function (row, data, index) {
                    if (data[7] == 0) {
                        $('td:eq(7)', row).html("{% trans 'NOT PROCESSED' %}");
                        $('td:eq(7)', row).addClass('statusnotprocessed');
                    }
                    if (data[7] == 1) {
                        $('td:eq(7)', row).html("{% trans 'PROCESSED' %}");
                        $('td:eq(7)', row).addClass('statusprocessed');
                    }
                    if (data[7] == 2) {
                        $('td:eq(7)', row).html("{% trans 'LOW RED' %}");
                        $('td:eq(7)', row).addClass('statuslowred');
                    }
                    if (data[7] == 3) {
                        $('td:eq(7)', row).html("{% trans 'LOW YELLOW' %}");
                        $('td:eq(7)', row).addClass('statuslowyellow');
                    }
                    if (data[7] == 4) {
                        $('td:eq(7)', row).html("{% trans 'GREEN' %}");
                        $('td:eq(7)', row).addClass('statusgreen');
                    }
                    if (data[7] == 5) {
                        $('td:eq(7)', row).html("{% trans 'HIGH YELLOW' %}");
                        $('td:eq(7)', row).addClass('statushighyellow');
                    }
                    if (data[7] == 6) {
                        $('td:eq(7)', row).html("{% trans 'HIGH RED' %}");
                        $('td:eq(7)', row).addClass('statushighred');
                    }
                },
                "initComplete": function (settings, json) {
                    this.api().columns().every(function () {
                        var column = this;
                        var select = $('<select><option value=""></option></select>')
                            .appendTo($(column.footer()).empty())
                            .on('change', function () {
                                var val = $.fn.dataTable.util.escapeRegex($(this).val());
                                column.search(val ? '^' + val + '$' : '', true, false).draw();
                            });
                        column.data().unique().sort().each(function (d, j) {
                            if (column.search() === '^' + d + '$') {
                                select.append('<option value="' + d + '" selected="selected">' + d + '</option>')
                            } else {
                                select.append('<option value="' + d + '">' + d + '</option>')
                            }
                        });
                    })
                }
            });
        })
        ;

    </script>
{% endblock %}

{% block content %}
    <p></p>
    <table id="statustable" class="table table-striped table-bordered" cellspacing="0" width="100%">
        <thead>
        <tr>
            <th>{% trans "Tag#" %}</th>
            <th>{% trans "Tag Description" %}</th>
            <th>{% trans "VP#" %}</th>
            <th>{% trans "VP Description" %}</th>
            <th>{% trans "Value" %}</th>
            <th>{% trans "Unit" %}</th>
            <th>{% trans "Value Date" %}</th>
            <th>{% trans "Value State" %}</th>
            <th>{% trans "Processed Date" %}</th>
        </tr>
        </thead>
        <tfoot>
        <tr>
            <th>{% trans "Tag#" %}</th>
            <th>{% trans "Tag Description" %}</th>
            <th>{% trans "VP#" %}</th>
            <th>{% trans "VP Description" %}</th>
            <th>{% trans "Value" %}</th>
            <th>{% trans "Unit" %}</th>
            <th>{% trans "Value Date" %}</th>
            <th>{% trans "Value State" %}</th>
            <th>{% trans "Processed Date" %}</th>
        </tr>
        </tfoot>
        <tbody>
        </tbody>
    </table>
{% endblock %}